{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"c801\"],{c801:function(e,t,r){\"use strict\";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r(\"div\",[r(\"Row\",[r(\"Col\",{attrs:{span:\"24\"}},[r(\"Card\",{attrs:{\"dis-hover\":!0}},[r(\"p\",{attrs:{slot:\"title\"},slot:\"title\"},[r(\"Icon\",{attrs:{type:\"md-person\"}}),e._v(\"\\n        用户列表\\n      \")],1),r(\"Card\",{staticStyle:{\"padding-top\":\"20px\"},attrs:{padding:0}},[r(\"Form\",{ref:\"userSearchData\",staticStyle:{margin:\"0px\"},attrs:{model:e.userSearchData,rules:e.userSearchData,inline:\"\"}},[r(\"FormItem\",{attrs:{label:\"帐号\",prop:\"username\",\"label-width\":50}},[r(\"Input\",{attrs:{placeholder:\"帐号\"},model:{value:e.userSearchData.username,callback:function(t){e.$set(e.userSearchData,\"username\",t)},expression:\"userSearchData.username\"}})],1),r(\"FormItem\",{attrs:{label:\"名称\",prop:\"nickname\",\"label-width\":50}},[r(\"Input\",{attrs:{type:\"text\",placeholder:\"名称\"},model:{value:e.userSearchData.nickname,callback:function(t){e.$set(e.userSearchData,\"nickname\",t)},expression:\"userSearchData.nickname\"}})],1),r(\"FormItem\",{attrs:{label:\"手机号\",prop:\"cellphone\",\"label-width\":50}},[r(\"Input\",{attrs:{type:\"text\",placeholder:\"手机号\"},model:{value:e.userSearchData.cellphone,callback:function(t){e.$set(e.userSearchData,\"cellphone\",t)},expression:\"userSearchData.cellphone\"}})],1),r(\"FormItem\",{attrs:{label:\"性别\",prop:\"gender\",\"label-width\":50}},[r(\"Select\",{staticStyle:{width:\"70px\"},attrs:{clearable:\"\"},model:{value:e.userSearchData.gender,callback:function(t){e.$set(e.userSearchData,\"gender\",t)},expression:\"userSearchData.gender\"}},[r(\"Option\",{attrs:{value:\"1\"}},[e._v(\"男\")]),r(\"Option\",{attrs:{value:\"0\"}},[e._v(\"女\")])],1)],1),r(\"FormItem\",{attrs:{label:\"状态\",prop:\"status\",\"label-width\":50}},[r(\"Select\",{staticStyle:{width:\"70px\"},attrs:{clearable:\"\"},model:{value:e.userSearchData.status,callback:function(t){e.$set(e.userSearchData,\"status\",t)},expression:\"userSearchData.status\"}},[r(\"Option\",{attrs:{value:\"0\"}},[e._v(\"不启用\")]),r(\"Option\",{attrs:{value:\"1\",checked:\"\"}},[e._v(\"正常\")]),r(\"Option\",{attrs:{value:\"2\"}},[e._v(\"禁用\")]),r(\"Option\",{attrs:{value:\"3\"}},[e._v(\"删除\")])],1)],1),r(\"FormItem\",[r(\"span\",{staticStyle:{\"padding-left\":\"50px\"}}),r(\"Button\",{attrs:{type:\"primary\",icon:\"md-search\"},on:{click:e.handleSearchUser}},[e._v(\"搜索\")])],1),r(\"FormItem\",[r(\"Button\",{attrs:{icon:\"md-refresh\"},on:{click:function(t){e.handleCancelUser(\"userSearchData\")}}},[e._v(\"重置\")])],1)],1)],1),r(\"Card\",{staticStyle:{\"margin-top\":\"10px\"}},[r(\"Row\",{attrs:{type:\"flex\",justify:\"start\"}},[r(\"ButtonGroup\",{attrs:{size:\"large\"}},[r(\"Button\",{attrs:{icon:\"md-add\"},on:{click:e.addUser}},[e._v(\"添加\")]),r(\"Button\",{attrs:{icon:\"md-settings\",disabled:e.canEditUserRole},on:{click:e.editUserRole}},[e._v(\"修改用户角色\")]),r(\"Button\",{attrs:{icon:\"md-close\",disabled:e.canDelete},on:{click:e.deleteUser}},[e._v(\"删除\")])],1),r(\"span\",{staticStyle:{\"margin-left\":\"10px\"}}),r(\"ButtonGroup\",{attrs:{size:\"large\"}},[r(\"Button\",{attrs:{icon:\"md-refresh\"},on:{click:e.refreshTable}},[e._v(\"刷新\")]),r(\"Button\",{attrs:{icon:\"md-reorder\"},on:{click:e.showUserColumns}},[e._v(\"显示列\")])],1)],1)],1),r(\"Card\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{padding:0,bordered:!1}},[r(\"Row\",[r(\"Table\",{attrs:{height:\"520\",loading:e.loading,columns:e.userColumn,data:e.userData,border:\"\",stripe:\"\"},on:{\"on-selection-change\":e.selectionChange}})],1),r(\"Row\",{attrs:{type:\"flex\",justify:\"center\"}},[r(\"Page\",{staticStyle:{margin:\"10px\"},attrs:{total:e.pageInfo.totalPages,current:e.pageInfo.currentPage,\"page-size\":e.pageInfo.pageSize,\"page-size-opts\":e.pageInfo.pageSizeOpt,\"show-elevator\":\"\",\"show-sizer\":\"\",\"show-total\":\"\",placement:\"top\"},on:{\"on-change\":e.changePage,\"on-page-size-change\":e.changeSize}})],1)],1)],1)],1)],1),r(\"Modal\",{attrs:{title:e.userFormItem.modalTitle,closable:!1,\"mask-closable\":!1,loading:e.userModalLoading,\"ok-text\":\"提交\",\"cancel-text\":\"取消\"},on:{\"on-ok\":function(t){e.userModalSubmit(\"userFormItem\")},\"on-cancel\":function(t){e.userModalCancel(\"userFormItem\")}},model:{value:e.addUserModal,callback:function(t){e.addUserModal=t},expression:\"addUserModal\"}},[r(\"Form\",{ref:\"userFormItem\",attrs:{model:e.userFormItem,rules:e.userRuleValidate,\"label-width\":80}},[r(\"FormItem\",{attrs:{label:\"帐号\",prop:\"username\"}},[r(\"Input\",{attrs:{placeholder:\"输入登录帐号...\"},model:{value:e.userFormItem.username,callback:function(t){e.$set(e.userFormItem,\"username\",t)},expression:\"userFormItem.username\"}})],1),r(\"FormItem\",{attrs:{label:\"姓名\",prop:\"nickname\"}},[r(\"Input\",{attrs:{placeholder:\"输入用户名称...\"},model:{value:e.userFormItem.nickname,callback:function(t){e.$set(e.userFormItem,\"nickname\",t)},expression:\"userFormItem.nickname\"}})],1),r(\"FormItem\",{attrs:{label:\"手机号\",prop:\"cellphone\"}},[r(\"Input\",{attrs:{placeholder:\"输入手机号...\"},model:{value:e.userFormItem.cellphone,callback:function(t){e.$set(e.userFormItem,\"cellphone\",t)},expression:\"userFormItem.cellphone\"}})],1),r(\"FormItem\",{attrs:{label:\"邮箱\",prop:\"email\"}},[r(\"Input\",{attrs:{placeholder:\"输入邮箱...\"},model:{value:e.userFormItem.email,callback:function(t){e.$set(e.userFormItem,\"email\",t)},expression:\"userFormItem.email\"}})],1),r(\"FormItem\",{attrs:{label:\"地址\",prop:\"address\"}},[r(\"Input\",{attrs:{placeholder:\"输入居住地址...\"},model:{value:e.userFormItem.address,callback:function(t){e.$set(e.userFormItem,\"address\",t)},expression:\"userFormItem.address\"}})],1),r(\"FormItem\",{attrs:{label:\"出生日期\",prop:\"birthday\"}},[r(\"Row\",[r(\"Col\",{attrs:{span:\"11\"}},[r(\"DatePicker\",{attrs:{type:\"date\",format:\"yyyy-MM-dd\",placeholder:\"选择日期\",value:\"userFormItem.birthday\"},on:{\"on-change\":function(t){e.userFormItem.birthday=t}}})],1)],1)],1),r(\"FormItem\",{attrs:{label:\"性别\",prop:\"gender\"}},[r(\"RadioGroup\",{model:{value:e.userFormItem.gender,callback:function(t){e.$set(e.userFormItem,\"gender\",t)},expression:\"userFormItem.gender\"}},[r(\"Radio\",{attrs:{label:\"1\"}},[e._v(\"男\")]),r(\"Radio\",{attrs:{label:\"0\"}},[e._v(\"女\")])],1)],1),r(\"FormItem\",{attrs:{label:\"用户状态\",prop:\"status\"}},[r(\"Select\",{model:{value:e.userFormItem.status,callback:function(t){e.$set(e.userFormItem,\"status\",t)},expression:\"userFormItem.status\"}},[r(\"Option\",{attrs:{value:\"0\"}},[e._v(\"不启用\")]),r(\"Option\",{attrs:{value:\"1\"}},[e._v(\"正常\")]),r(\"Option\",{attrs:{value:\"2\"}},[e._v(\"禁用\")]),r(\"Option\",{attrs:{value:\"3\",disabled:\"\"}},[e._v(\"删除\")])],1)],1),r(\"FormItem\",{attrs:{label:\"备注\",prop:\"descn\"}},[r(\"Input\",{attrs:{type:\"textarea\",autosize:{minRows:2,maxRows:5},placeholder:\"备注信息...\"},model:{value:e.userFormItem.descn,callback:function(t){e.$set(e.userFormItem,\"descn\",t)},expression:\"userFormItem.descn\"}})],1)],1)],1),r(\"Modal\",{attrs:{title:\"修改用户角色\",closable:!1,\"mask-closable\":!1,\"ok-text\":\"提交\",\"cancel-text\":\"取消\"},on:{\"on-ok\":function(t){e.roleModalSubmit()},\"on-cancel\":function(t){e.roleModalCancel()}},model:{value:e.roleModal,callback:function(t){e.roleModal=t},expression:\"roleModal\"}},[r(\"Form\",{ref:\"roleFormItem\",attrs:{rules:e.roleRuleValidate,model:e.roleFormItem}},[r(\"FormItem\",{attrs:{prop:\"roleList\"}},[r(\"CheckboxGroup\",{model:{value:e.roleFormItem.roleList,callback:function(t){e.$set(e.roleFormItem,\"roleList\",t)},expression:\"roleFormItem.roleList\"}},e._l(e.roleFormItem.allRoles,function(t){return r(\"Checkbox\",{attrs:{label:t.id}},[e._v(e._s(t.name)+\"  (\"+e._s(t.descn)+\")  \")])}))],1)],1)],1)],1)},o=[],s=(r(\"7f7f\"),r(\"66df\")),n=function(e){var t=e.data,r=e.token;return s[\"a\"].request({url:\"/admin-server/user/findUsersWithPaging\",params:{data:t,token:r},method:\"get\"})},l=function(e){return s[\"a\"].request({url:\"/admin-server/user/deleteUser\",data:e,method:\"post\"})},i=function(e){return console.log(e),s[\"a\"].request({url:\"/admin-server/user/addUser\",data:e,method:\"post\"})},d=function(e){var t=e.data,r=e.token;return s[\"a\"].request({url:\"/admin-server/role/findAllRoles\",params:{data:t,token:r},method:\"get\"})},c={name:\"userinfo-table\",data:function(){var e=this;return{userColumn:[{type:\"selection\",width:60,align:\"center\",fixed:\"left\"},{type:\"ind\",title:\"序号\",width:65,align:\"center\",render:function(t,r){return t(\"span\",r.index+(e.pageInfo.currentPage-1)*e.pageInfo.pageSize+1)}},{key:\"username\",title:\"帐号\",align:\"center\",width:200},{key:\"nickname\",title:\"名称\",align:\"center\",width:200},{key:\"email\",title:\"邮箱\",align:\"center\",width:200},{key:\"cellphone\",title:\"电话号码\",align:\"center\",width:200},{key:\"gender\",title:\"性别\",align:\"center\",width:100,render:function(e,t){var r=t.row,a=1===r.gender?\"blue\":0===r.gender?\"red\":\"black\",o=1===r.gender?\"男\":0===r.gender?\"女\":\"空\";return e(\"Tag\",{props:{type:\"border\",color:a}},o)}},{key:\"address\",title:\"居住地址\",align:\"center\",width:200},{key:\"birthday\",title:\"生日\",align:\"center\",width:200},{key:\"status\",title:\"启用状态\",align:\"center\",width:100,render:function(e,t){var r=\"空值\",a=\"black\";return 0==t.row.status?(r=\"未启用\",a=\"yellow\"):1==t.row.status?(r=\"正常\",a=\"green\"):2==t.row.status?(r=\"禁用\",a=\"red\"):3==t.row.status&&(r=\"删除\",a=\"gray\"),e(\"Tag\",{props:{type:\"border\",color:a}},r)}},{key:\"roles\",title:\"用户角色\",align:\"center\",width:150,render:function(e,t){for(var r=0;r<t.row.roles.length;r++)return e(\"Tag\",{props:{type:\"border\"}},t.row.roles[r].name)}},{key:\"createTime\",title:\"创建时间\",align:\"center\",width:150,render:function(e,t){return e(\"div\",null==t.row.createTime?\"\":new Date(t.row.createTime).format(\"yyyy-MM-dd hh:mm:ss\"))}},{key:\"updateTime\",title:\"最后更新时间\",align:\"center\",width:150,render:function(e,t){return e(\"div\",null==t.row.updateTime?\"\":new Date(t.row.updateTime).format(\"yyyy-MM-dd hh:mm:ss\"))}},{key:\"descn\",title:\"备注信息\",align:\"center\",width:150},{title:\"操作\",key:\"action\",width:150,align:\"center\",fixed:\"right\",render:function(t,r){return t(\"div\",[t(\"Button\",{props:{type:\"primary\",size:\"small\"},style:{marginRight:\"5px\"},on:{click:function(){e.editUser(r)}}},\"修改\"),t(\"Button\",{props:{type:\"error\",size:\"small\"},on:{click:function(){e.deleteUser(r,!0)}}},\"删除\")])}}],userData:[],userSearchData:{username:\"\",nickname:\"\",status:1,gender:\"\",cellphone:\"\"},pageInfo:{totalPages:0,currentPage:1,pageSize:10,pageSizeOpt:[10,20,30,50]},value1:[1,2],addUserModal:!1,roleModal:!1,userFormItem:{modalTitle:\"\",modalSubmitType:\"\",id:\"\",username:\"\",nickname:\"\",email:\"\",cellphone:\"\",address:\"\",gender:1,status:1,birthday:\"\",descn:\"\"},roleFormItem:{roleList:[],allRoles:[]},userRuleValidate:{username:[{required:!0,message:\"帐号不能为空\",trigger:\"blur\"}],nickname:[{required:!0,message:\"姓名不能为空\",trigger:\"blur\"}],email:[{type:\"email\",message:\"邮箱格式错误\",trigger:\"blur\"}]},roleRuleValidate:{roleList:[{required:!0,type:\"array\",min:1,message:\"最少选择一个角色\",trigger:\"change\"},{type:\"array\",max:5,message:\"最多选择五个角色\",trigger:\"change\"}]},loading:!0,userModalLoading:!0,userTableSelectData:[],canEditUserRole:!0,canDelete:!0}},methods:{init:function(){},changePage:function(e){this.pageInfo.currentPage=e,this.refreshTable()},changeSize:function(e){this.pageInfo.pageSize=e,this.refreshTable()},refreshTable:function(){var e=this;this.loading=!0;var t={username:this.userSearchData.username,nickname:this.userSearchData.nickname,gender:this.userSearchData.gender,cellphone:this.userSearchData.cellphone,status:this.userSearchData.status,currentPage:this.pageInfo.currentPage,pageSize:this.pageInfo.pageSize},r=\"123\";n({data:t,token:r}).then(function(t){e.pageInfo.totalPages=t.data.data.total,e.userData=t.data.data.list,e.loading=!1}).catch(function(t){e.$Notice.error({title:\"错误提示\",duration:5,desc:t+\"<br/>无法获取后台数据！\"}),e.loading=!1})},initRoles:function(){var e=this;this.roleFormItem.roleList=[];var t=this.userTableSelectData;if(1==t.length)for(var r=0;r<t[0].roles.length;r++)this.roleFormItem.roleList[r]=t[0].roles[r].id;var a={},o=\"123\";d({data:a,token:o}).then(function(t){e.roleFormItem.allRoles=t.data.data}).catch(function(t){e.$Notice.error({title:\"错误提示\",duration:5,desc:t+\"<br/>无法获取后台数据！\"})})},handleSearchUser:function(){this.refreshTable()},handleCancelUser:function(e){this.$refs[e].resetFields()},addUser:function(){this.userFormItem={},this.userFormItem.gender=1,this.userFormItem.status=1,this.userFormItem.modalTitle=\"添加用户\",this.userFormItem.modalSubmitType=\"add\",this.addUserModal=!0},editUser:function(e){this.userFormItem=e.row,this.userFormItem.modalTitle=\"修改用户\",this.userFormItem.modalSubmitType=\"edit\",this.addUserModal=!0},deleteUser:function(e,t){var r=this;t&&(this.userTableSelectData=[],this.userTableSelectData[0]=e.row),this.userTableSelectData.length>0&&this.$Modal.confirm({title:\"提示\",content:\"<h2>确定删除用户信息？</h2>\",onOk:function(){for(var e=\"\",t=0;t<r.userTableSelectData.length;t++)t>0&&(e+=\",\"),e+=r.userTableSelectData[t].id;var a=new URLSearchParams;a.append(\"data\",e),a.append(\"token\",\"123\"),l(a).then(function(e){r.$Notice.success({duration:3,desc:\"删除用户成功！\"}),r.refreshTable(),r.$Loading.finish()}).catch(function(e){r.$Notice.error({title:\"错误提示\",duration:5,desc:e+\"<br/>无法获取后台数据！\"}),r.loading=!1})}})},editUserRole:function(){this.initRoles(),this.roleModal=!0},showUserColumns:function(){},userModalSubmit:function(e){var t=this;this.$Loading.start(),this.$refs[e].validate(function(r){if(r){var a=new URLSearchParams;a.append(\"data\",JSON.stringify(t.userFormItem)),a.append(\"token\",\"123\"),\"add\"==t.userFormItem.modalSubmitType?i(a).then(function(r){200==r.data.code?(t.$Notice.success({duration:3,desc:\"用户添加成功！\"}),t.refreshTable(),t.$refs[e].resetFields(),t.$Loading.finish()):(t.$Modal.error({width:650,title:\"错误提示\",content:\"<p style='text-align:left;color:red;font-size:20px;word-wrap:break-word; word-break:normal;'>500 \"+r.data.msg+\" </p><p style='font-size:14px;word-wrap:break-word; word-break:normal;'>详细内容：\"+r.data.data+\"</p>\"}),t.$Loading.error())}).catch(function(e){t.$Notice.error({title:\"错误提示\",duration:5,desc:e+\"<br/>无法获取后台数据！\"}),t.loading=!1}):\"edit\"==t.userFormItem.modalSubmitType?t.$axios.post(\"/admin-server/user/updateUser\",postData).then(function(r){200==r.data.code&&(t.$Notice.success({duration:3,desc:\"用户修改成功！\"}),t.refreshTable(),t.$refs[e].resetFields(),t.$Loading.finish()),500==r.data.code&&(t.$Modal.error({width:650,title:\"错误提示\",content:\"<p style='text-align:left;color:red;font-size:20px;word-wrap:break-word; word-break:normal;'>500 \"+r.data.msg+\" </p><p style='font-size:14px;word-wrap:break-word; word-break:normal;'>详细内容：\"+r.data.data+\"</p>\"}),t.$Loading.error())}).catch(function(e){t.$Notice.error({title:\"错误提示\",duration:5,desc:e+\"<br/>无法获取后台数据！\"}),t.loading=!1}):t.$Message.error(\"Fail!  DATA ERROR!!!\")}else setTimeout(function(){t.userModalLoading=!1,t.$nextTick(function(){t.userModalLoading=!0})},1e3),t.$Message.error({content:\"请检查表单填写信息!\",duration:3})})},userModalCancel:function(e){},selectionChange:function(e){0==e.length?(this.canEditUserRole=!0,this.canDelete=!0):e.length>=1&&(this.canEditUserRole=!1,this.canDelete=!1),this.userTableSelectData=e},roleModalSubmit:function(){for(var e=this,t=[],r=0;r<this.userTableSelectData.length;r++)t[r]=this.userTableSelectData[r].id;var a={userId:t,roleId:this.roleFormItem.roleList},o=this.$qs.stringify({data:JSON.stringify(a),token:\"123\"});this.$axios.post(\"/admin-server/user/updateUserRole\",o).then(function(t){console.log(t),200==t.data.code?(e.$Notice.success({duration:3,desc:\"修改用户角色成功！\"}),e.refreshTable(),e.$Loading.finish()):(e.$Modal.error({width:650,title:\"错误提示\",content:\"<p style='text-align:left;color:red;font-size:20px;word-wrap:break-word; word-break:normal;'>500 \"+t.data.msg+\" </p><p style='font-size:14px;word-wrap:break-word; word-break:normal;'>详细内容：\"+t.data.data+\"</p>\"}),e.$Loading.error())})},roleModalCancel:function(){}},mounted:function(){this.$Loading.start(),this.init(),this.refreshTable(),this.$Loading.finish()}},u=c,m=r(\"2877\"),p=Object(m[\"a\"])(u,a,o,!1,null,null,null);p.options.__file=\"usermain.vue\";t[\"default\"]=p.exports}}]);","extractedComments":[]}