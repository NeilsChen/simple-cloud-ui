{"remainingRequest":"D:\\vue_workspace\\iview-admin-11-7\\node_modules\\thread-loader\\dist\\cjs.js!D:\\vue_workspace\\iview-admin-11-7\\node_modules\\babel-loader\\lib\\index.js!D:\\vue_workspace\\iview-admin-11-7\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vue_workspace\\iview-admin-11-7\\src\\view\\user-manager\\roleinfo\\rolemain.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\vue_workspace\\iview-admin-11-7\\src\\view\\user-manager\\roleinfo\\rolemain.vue","mtime":1541562986327},{"path":"D:\\vue_workspace\\iview-admin-11-7\\.babelrc","mtime":1541498101000},{"path":"D:\\vue_workspace\\iview-admin-11-7\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1541557854009},{"path":"D:\\vue_workspace\\iview-admin-11-7\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vue_workspace\\iview-admin-11-7\\node_modules\\babel-loader\\lib\\index.js","mtime":1529635966000},{"path":"D:\\vue_workspace\\iview-admin-11-7\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport resourceTree from \"./resource-tree\";\nexport default {\n  name: \"roleinfo-table\",\n  components: {\n    resourceTree: resourceTree\n  },\n  data: function data() {\n    var _this = this;\n\n    return {\n      tableColumn: [{\n        type: \"selection\",\n        width: 60,\n        align: \"center\",\n        fixed: \"left\"\n      }, {\n        type: \"ind\",\n        title: \"序号\",\n        width: 65,\n        align: \"center\",\n        render: function render(h, params) {\n          return h(\"span\", params.index + (_this.pageInfo.currentPage - 1) * _this.pageInfo.pageSize + 1);\n        }\n      }, {\n        key: \"name\",\n        title: \"名称\",\n        align: \"center\",\n        width: 200\n      }, {\n        key: \"status\",\n        title: \"启用状态\",\n        align: \"center\",\n        width: 100,\n        render: function render(h, params) {\n          var texts = \"空值\";\n          var color = \"black\";\n\n          if (params.row.status == 0) {\n            texts = \"未启用\";\n            color = \"yellow\";\n          } else if (params.row.status == 1) {\n            texts = \"正常\";\n            color = \"green\";\n          } else if (params.row.status == 2) {\n            texts = \"禁用\";\n            color = \"red\";\n          } else if (params.row.status == 3) {\n            texts = \"删除\";\n            color = \"gray\";\n          } // return h('div',{props: {}},texts);\n\n\n          return h(\"Tag\", {\n            props: {\n              type: \"border\",\n              color: color\n            }\n          }, texts);\n        }\n      }, {\n        key: \"createTime\",\n        title: \"创建时间\",\n        align: \"center\",\n        width: 150,\n        render: function render(h, params) {\n          return h(\"div\", params.row.createTime == null ? \"\" : new Date(params.row.createTime).format(\"yyyy-MM-dd hh:mm:ss\"));\n        }\n      }, {\n        key: \"updateTime\",\n        title: \"最后更新时间\",\n        align: \"center\",\n        width: 150,\n        render: function render(h, params) {\n          return h(\"div\", params.row.updateTime == null ? \"\" : new Date(params.row.updateTime).format(\"yyyy-MM-dd hh:mm:ss\"));\n        }\n      }, {\n        key: \"descn\",\n        title: \"备注信息\",\n        align: \"center\",\n        width: 150\n      }, {\n        title: \"操作\",\n        key: \"action\",\n        width: 200,\n        align: \"center\",\n        fixed: \"right\",\n        render: function render(h, params) {\n          return h(\"div\", [h(\"Button\", {\n            props: {\n              type: \"primary\",\n              size: \"small\"\n            },\n            style: {\n              marginRight: \"5px\"\n            },\n            on: {\n              click: function click() {\n                _this.editUser(params);\n              }\n            }\n          }, \"修改\"), h(\"Button\", {\n            props: {\n              type: \"error\",\n              size: \"small\"\n            },\n            style: {\n              marginRight: \"5px\"\n            },\n            on: {\n              click: function click() {\n                _this.deleteUser(params, true);\n              }\n            }\n          }, \"删除\"), h(\"Button\", {\n            props: {\n              type: \"default\",\n              size: \"small\"\n            },\n            on: {\n              click: function click() {\n                _this.updatePermission(params);\n              }\n            }\n          }, \"关联资源\")]);\n        }\n      }],\n      tableData: [{\n        id: 1,\n        name: \"cs1\",\n        status: 1,\n        createTime: null,\n        updateTime: null,\n        descn: \"ccccsssss1\"\n      }, {\n        id: 2,\n        name: \"cs2\",\n        status: 2,\n        createTime: null,\n        updateTime: null,\n        descn: \"ccccsssss2\"\n      }],\n      searchData: {\n        name: \"\",\n        descn: \"\",\n        status: 1\n      },\n      pageInfo: {\n        totalPages: 0,\n        currentPage: 1,\n        pageSize: 10,\n        pageSizeOpt: [10, 20, 30, 50]\n      },\n      value1: [1, 2],\n      addModal: false,\n      resourceModal: false,\n      modalFormItem: {\n        modalTitle: \"\",\n        modalSubmitType: \"\",\n        id: \"\",\n        name: \"\",\n        status: 1,\n        descn: \"\"\n      },\n      formRuleValidate: {\n        name: [{\n          required: true,\n          message: \"名称不能为空\",\n          trigger: \"blur\"\n        }]\n      },\n      treedata: {\n        roleId: 0\n      },\n      loading: true,\n      modalLoading: true,\n      modalLoading2: true,\n      tableSelectData: [],\n      canDelete: true\n    };\n  },\n  methods: {\n    init: function init() {},\n    changePage: function changePage(page) {\n      this.pageInfo.currentPage = page;\n      this.refreshTable();\n    },\n    changeSize: function changeSize(size) {\n      this.pageInfo.pageSize = size;\n      this.refreshTable();\n    },\n    refreshTable: function refreshTable() {\n      var _this2 = this;\n\n      this.loading = true;\n      var data = {\n        name: this.searchData.name,\n        descn: this.searchData.descn,\n        status: this.searchData.status,\n        currentPage: this.pageInfo.currentPage,\n        pageSize: this.pageInfo.pageSize\n      };\n      var token = \"\";\n      this.$axios.get(\"/admin-server/role/findRolesWithPaging\", {\n        params: {\n          data: data,\n          token: token\n        }\n      }).then(function (res) {\n        _this2.pageInfo.totalPages = res.data.data.total;\n        _this2.tableData = res.data.data.list;\n        _this2.loading = false;\n      }).catch(function (error) {\n        _this2.$Notice.error({\n          title: \"错误提示\",\n          duration: 5,\n          desc: error + \"<br/>无法获取后台数据！\"\n        });\n\n        _this2.loading = false;\n      });\n    },\n    searchSubmit: function searchSubmit() {\n      this.refreshTable();\n    },\n    searchReset: function searchReset(name) {\n      this.$refs[name].resetFields();\n    },\n    //添加记录\n    addData: function addData() {\n      this.modalFormItem = {};\n      this.modalFormItem.gender = 1;\n      this.modalFormItem.status = 1;\n      this.modalFormItem.modalTitle = \"添加角色\";\n      this.modalFormItem.modalSubmitType = \"add\";\n      this.addModal = true;\n    },\n    //修改记录\n    editUser: function editUser(rowdata) {\n      this.modalFormItem = rowdata.row;\n      this.modalFormItem.modalTitle = \"修改角色\";\n      this.modalFormItem.modalSubmitType = \"edit\";\n      this.addModal = true;\n    },\n    //删除记录 \n    deleteData: function deleteData(data, isbatch) {\n      var _this3 = this;\n\n      if (isbatch) {\n        this.tableSelectData = [];\n        this.tableSelectData[0] = data.row;\n      }\n\n      if (this.tableSelectData.length > 0) {\n        this.$Modal.confirm({\n          title: \"提示\",\n          content: \"<h2>确定删除角色信息？</h2>\",\n          onOk: function onOk() {\n            var ids = new Array();\n\n            for (var i = 0; i < _this3.tableSelectData.length; i++) {\n              ids[i] = _this3.tableSelectData[i].id;\n            }\n\n            var postData = _this3.$qs.stringify({\n              data: JSON.stringify(ids),\n              token: \"123\"\n            });\n\n            _this3.$axios.post(\"/admin-server/role/deleteRole\", postData).then(function (res) {\n              if (res.data.code == 200) {\n                _this3.$Notice.success({\n                  // title: '提示消息',\n                  duration: 3,\n                  desc: \"删除角色成功！\"\n                });\n\n                _this3.refreshTable();\n\n                _this3.$Loading.finish();\n              }\n\n              if (res.data.code == 500) {\n                _this3.$Modal.error({\n                  width: 650,\n                  title: \"错误提示\",\n                  content: \"<p style='text-align:left;color:red;font-size:20px;word-wrap:break-word; word-break:normal;'>500 \" + res.data.msg + \" </p><p style='font-size:14px;word-wrap:break-word; word-break:normal;'>详细内容：\" + res.data.data + \"</p>\"\n                });\n\n                _this3.$Loading.error();\n              }\n            });\n          }\n        });\n      }\n    },\n    //提交表单\n    modalSubmit: function modalSubmit(name) {\n      var _this4 = this;\n\n      this.$Loading.start();\n      this.$refs[name].validate(function (valid) {\n        if (valid) {\n          var postData = _this4.$qs.stringify({\n            data: JSON.stringify(_this4.modalFormItem),\n            token: \"123\"\n          }); //添加用户\n\n\n          if (_this4.modalFormItem.modalSubmitType == \"add\") {\n            _this4.$axios.post(\"/admin-server/user/addUser\", postData).then(function (res) {\n              if (res.data.code == 200) {\n                _this4.$Notice.success({\n                  // title: '提示消息',\n                  duration: 5,\n                  desc: \"角色添加成功！\"\n                });\n\n                _this4.refreshTable();\n\n                _this4.$refs[name].resetFields();\n\n                _this4.$Loading.finish();\n              }\n\n              if (res.data.code == 500) {\n                _this4.$Modal.error({\n                  width: 650,\n                  title: \"错误提示\",\n                  content: \"<p style='text-align:left;color:red;font-size:20px;word-wrap:break-word; word-break:normal;'>500 \" + res.data.msg + \" </p><p style='font-size:14px;word-wrap:break-word; word-break:normal;'>详细内容：\" + res.data.data + \"</p>\"\n                });\n\n                _this4.$Loading.error();\n              }\n            }).catch(function (error) {\n              _this4.$Notice.error({\n                title: \"错误提示\",\n                duration: 10,\n                desc: error + \"<br/>无法获取后台数据！\"\n              });\n\n              _this4.loading = false;\n            }); //修改用户\n\n          } else if (_this4.modalFormItem.modalSubmitType == \"edit\") {\n            _this4.$axios.post(\"/admin-server/user/updateUser\", postData).then(function (res) {\n              if (res.data.code == 200) {\n                _this4.$Notice.success({\n                  // title: '提示消息',\n                  duration: 5,\n                  desc: \"角色修改成功！\"\n                });\n\n                _this4.refreshTable();\n\n                _this4.$refs[name].resetFields();\n\n                _this4.$Loading.finish();\n              }\n\n              if (res.data.code == 500) {\n                _this4.$Modal.error({\n                  width: 650,\n                  title: \"错误提示\",\n                  content: \"<p style='text-align:left;color:red;font-size:20px;word-wrap:break-word; word-break:normal;'>500 \" + res.data.msg + \" </p><p style='font-size:14px;word-wrap:break-word; word-break:normal;'>详细内容：\" + res.data.data + \"</p>\"\n                });\n\n                _this4.$Loading.error();\n              }\n            }).catch(function (error) {\n              _this4.$Notice.error({\n                title: \"错误提示\",\n                duration: 10,\n                desc: error + \"<br/>无法获取后台数据！\"\n              });\n\n              _this4.loading = false;\n            });\n          } else {\n            _this4.$Message.error(\"Fail!  DATA ERROR!!!\");\n          }\n        } else {\n          setTimeout(function () {\n            _this4.modalLoading = false;\n\n            _this4.$nextTick(function () {\n              _this4.modalLoading = true;\n            });\n          }, 1000);\n\n          _this4.$Message.error({\n            content: '请检查表单填写信息!',\n            duration: 3\n          });\n        }\n      });\n    },\n    modalCancel: function modalCancel(name) {//this.$refs[name].resetFields();\n    },\n    resModalSubmit: function resModalSubmit() {},\n    //角色关联资源\n    updatePermission: function updatePermission(data) {\n      var roleid = data.row.id;\n      this.treedata.roleId = roleid;\n      this.$refs.restree.findNodes(roleid);\n      this.resourceModal = true;\n    },\n    selectionChange: function selectionChange(selection) {\n      if (selection.length == 0) {\n        this.canDelete = true;\n      } else if (selection.length >= 1) {\n        this.canDelete = false;\n      }\n\n      this.tableSelectData = selection;\n    }\n  },\n  mounted: function mounted() {\n    this.$Loading.start();\n    this.init();\n    this.refreshTable();\n    this.$Loading.finish();\n  }\n};",null]}